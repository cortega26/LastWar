<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Critical Performance Optimization -->
    <style>
        /* CRITICAL CSS INLINED - DO NOT MODIFY */
        :root{--primary:#ff6b35;--bg:#0a0e1a;--bg-secondary:#1a1f2e;--text-primary:#ffffff;--text-secondary:#b8bcc8;--border:#2d3748;--nav-height:70px;--container-max:1400px;--transition-fast:0.15s ease-out}[data-theme="light"]{--bg:#ffffff;--bg-secondary:#f8fafc;--text-primary:#1a202c;--text-secondary:#4a5568;--border:#e2e8f0}*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}html{font-size:16px}body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;background:var(--bg);color:var(--text-primary);line-height:1.6;overflow-x:hidden;min-height:100vh;display:flex;flex-direction:column}.container{max-width:var(--container-max);margin:0 auto;padding:0 1.5rem}.nav-container{position:sticky;top:0;z-index:1000;background:rgba(10,14,26,0.95);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}.main-nav{max-width:var(--container-max);margin:0 auto;padding:0 1.5rem;display:flex;align-items:center;height:var(--nav-height)}.nav-brand{margin-right:auto}.brand-link{display:flex;align-items:center;font-size:1.5rem;font-weight:700;color:var(--text-primary);text-decoration:none}.brand-icon{margin-right:0.5rem;font-size:1.8rem}.hero-enhanced{min-height:60vh;display:flex;align-items:center;position:relative;overflow:hidden}.hero-content-enhanced{position:relative;z-index:2;text-align:center;max-width:900px;margin:0 auto}.hero-title-enhanced{font-size:clamp(2.5rem,5vw,4rem);font-weight:700;margin-bottom:1.5rem;color:var(--text-primary)}.hero-subtitle{font-size:1.3rem;color:var(--text-secondary);margin-bottom:2.5rem;line-height:1.6}.loading-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(10,14,26,0.9);display:flex;align-items:center;justify-content:center;z-index:9999;opacity:0;visibility:hidden;transition:all 0.3s ease}.loading-overlay.active{opacity:1;visibility:visible}.loading-spinner{width:60px;height:60px;border:3px solid rgba(255,107,53,0.1);border-top:3px solid var(--primary);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.loading-text{color:var(--text-primary);font-size:1.1rem;text-align:center}.content{flex:1;padding:2rem 0}@media (max-width:768px){.container{padding:0 1rem}.main-nav{padding:0 1rem}.hero-title-enhanced{font-size:2.5rem}.hero-subtitle{font-size:1.1rem}}
    </style>
    
    <!-- Essential Meta -->
    <title>LastWar Tools - Strategic Command Center</title>
    <meta name="description" content="Interactive calculators, comprehensive guides, and real-time tools to dominate every season.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">

    <!-- Font Optimization - Preload Critical Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">
    </noscript>

    <!-- Non-Critical CSS - Async Loading -->
    <link rel="preload" href="assets/css/styles-optimized.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="assets/css/styles-optimized.css">
    </noscript>

    <!-- Search CSS - Defer -->
    <link rel="preload" href="assets/css/search.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="assets/css/search.css">
    </noscript>

    <!-- Open Graph -->
    <meta property="og:title" content="LastWar Tools - Strategic Command Center">
    <meta property="og:description" content="Interactive calculators, guides, and strategic tools for Last War: Survival">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tooltician.com">

    <!-- Theme Detection Script - Inline for Performance -->
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || 
                         (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>

    <!-- Optimized Google Analytics - Defer Loading -->
    <script>
        // Defer GA loading to not block rendering
        window.addEventListener('load', function() {
            const script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-TV9L6C3VN7';
            document.head.appendChild(script);
            
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-TV9L6C3VN7', {
                // Only load essential features to reduce bundle size
                send_page_view: true,
                anonymize_ip: true,
                cookie_flags: 'SameSite=None;Secure'
            });
        });
    </script>
</head>

<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Skip to Content for Accessibility -->
    <a href="#main-content" class="skip-to-content">Skip to main content</a>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div>
            <div class="loading-spinner"></div>
            <div class="loading-text">Initializing Strategic Command Center...</div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Navigation -->
    <nav class="nav-container" role="navigation" aria-label="Main navigation">
        <div class="main-nav">
            <div class="nav-brand">
                <a href="/" class="brand-link" aria-label="LastWar Tools Homepage">
                    <span class="brand-icon" aria-hidden="true">⚔️</span>
                    <span class="brand-text">LastWar<span class="brand-accent">Tools</span></span>
                </a>
            </div>
            
            <!-- Navigation Menu - Load Async -->
            <div id="nav-menu-placeholder"></div>
        </div>
    </nav>

    <!-- Main Content -->
    <main role="main" class="content" id="main-content">
        <!-- Enhanced Hero Section -->
        <section class="hero-enhanced">
            <div class="container">
                <div class="hero-content-enhanced fade-in">
                    <h1 class="hero-title-enhanced">
                        Strategic Command Center for
                        Last War: Survival
                    </h1>
                    <p class="hero-subtitle">
                        Master the battlefield with our comprehensive toolkit. Interactive calculators,
                        strategic guides, and real-time tools to dominate every season.
                    </p>
                    
                    <!-- Quick Action Buttons -->
                    <div class="hero-actions fade-in stagger-1">
                        <a href="/tools/hero-optimizer" class="" aria-label="
                            Hero Optimizer
                        ">
                            Hero Optimizer
                        </a>
                        <a href="/guides" class="" aria-label="
                            Strategy Guides
                        ">
                            Strategy Guides
                        </a>
                    </div>
                    
                    <!-- Hero Stats -->
                    <div class="hero-stats fade-in stagger-2">
                        <div class="hero-stat">
                            <span class="hero-stat-number">15+</span>
                            <span class="hero-stat-label">Strategic Tools</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number">50+</span>
                            <span class="hero-stat-label">Comprehensive Guides</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number">10k+</span>
                            <span class="hero-stat-label">Active Players</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tools Preview Section -->
        <section class="section">
            <div class="container">
                <h2 class="section-title">Essential Tools</h2>
                <div class="grid grid-3">
                    <div class="card fade-in stagger-1">
                        <h3>Hero Optimizer</h3>
                        <p>Calculate optimal hero builds, skill distributions, and equipment combinations for maximum battlefield effectiveness.</p>
                        <a href="/tools/hero-optimizer" class="" aria-label="Launch Tool">Launch Tool</a>
                    </div>
                    <div class="card fade-in stagger-2">
                        <h3>Resource Planner</h3>
                        <p>Plan resource allocation, upgrade paths, and construction timelines to maximize your base development efficiency.</p>
                        <a href="/tools/resource-planner" class="" aria-label="Launch Tool">Launch Tool</a>
                    </div>
                    <div class="card fade-in stagger-3">
                        <h3>Alliance Calculator</h3>
                        <p>Analyze alliance performance, coordinate member contributions, and optimize collective strategies.</p>
                        <a href="/tools/alliance-calculator" class="" aria-label="Launch Tool">Launch Tool</a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Non-Critical JavaScript - Defer Loading -->
    <script>
        // Load non-critical scripts after page load
        window.addEventListener('load', function() {
            // Load navigation component
            fetch('/partials/nav-menu.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('nav-menu-placeholder').innerHTML = html;
                });

            // Load footer component
            fetch('/partials/footer.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('footer-placeholder').innerHTML = html;
                });

            // Initialize search functionality
            if (typeof initializeSearch === 'function') {
                initializeSearch();
            }

            // Remove loading overlay
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.classList.remove('active');
                setTimeout(() => loadingOverlay.remove(), 300);
            }
        });

        // Critical performance monitoring
        function measureCoreWebVitals() {
            if ('PerformanceObserver' in window) {
                new PerformanceObserver((list) => {
                    list.getEntries().forEach((entry) => {
                        if (entry.entryType === 'navigation') {
                            // LCP measurement
                            if (window.gtag) {
                                gtag('event', 'core_web_vitals', {
                                    metric_name: 'LCP',
                                    metric_value: entry.largestContentfulPaint,
                                    page_path: window.location.pathname
                                });
                            }
                        }
                    });
                }).observe({entryTypes: ['navigation']});

                // CLS measurement
                new PerformanceObserver((list) => {
                    let clsValue = 0;
                    list.getEntries().forEach((entry) => {
                        if (!entry.hadRecentInput) {
                            clsValue += entry.value;
                        }
                    });
                    if (window.gtag) {
                        gtag('event', 'core_web_vitals', {
                            metric_name: 'CLS',
                            metric_value: clsValue,
                            page_path: window.location.pathname
                        });
                    }
                }).observe({entryTypes: ['layout-shift']});
            }
        }

        // Initialize performance monitoring after load
        window.addEventListener('load', measureCoreWebVitals);
    </script>

    <!-- Service Worker Registration - Progressive Enhancement -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>